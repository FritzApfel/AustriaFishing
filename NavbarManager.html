// navbar.js

class NavbarManager {
constructor(navbarId = 'navbar', loginLinkId = 'login-link') {
this.navbar = document.getElementById(navbarId);
this.loginLink = document.getElementById(loginLinkId);
this.userKey = 'userLoggedIn';

this.init();
}

init() {
document.addEventListener('DOMContentLoaded', () => this.updateNavbar());
}

isLoggedIn() {
return !!localStorage.getItem(this.userKey);
}

getLoggedInUser() {
return localStorage.getItem(this.userKey);
}

logout() {
localStorage.removeItem(this.userKey);
alert('Sie wurden abgemeldet.');
location.reload();
}

createUserSpan(email) {
const span = document.createElement('span');
span.id = 'user-email-span';
span.textContent = `Angemeldet als ${email}`;
span.style.marginLeft = '10px';
span.style.marginRight = '10px';
return span;
}

createLogoutButton() {
const btn = document.createElement('button');
btn.id = 'logout-btn';
btn.textContent = 'Abmelden';
btn.addEventListener('click', () => this.logout());
return btn;
}

clearExistingElements() {
const oldSpan = document.getElementById('user-email-span');
const oldBtn = document.getElementById('logout-btn');
if (oldSpan) oldSpan.remove();
if (oldBtn) oldBtn.remove();
}

updateNavbar() {
const user = this.getLoggedInUser();
this.clearExistingElements();

if (user) {
if (this.loginLink) this.loginLink.style.display = 'none';
this.navbar.appendChild(this.createUserSpan(user));
this.navbar.appendChild(this.createLogoutButton());
} else {
if (this.loginLink) this.loginLink.style.display = 'inline';
}
}
}
